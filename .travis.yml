env:
  global:
  - secure: Vb4z2Fe88qgiTQFw/h3mt70cCnlUI3w+OJ+jwtmNF5A4zhGskiH13GXrSg0uySZ1lioENKUXo3C2HCy0guK4wjRqSFp2DL84VN+L0RQUv6H5r8Qx0S3BX2pBPyP7WpBuSfovMG9unkoxYL2DUN5vS5sv+GGWjPuw6lzJQmzfKY21PBE3Yua6bbe93eEJ0TL5h4QTl38mzzfZVcSubbDjchgMOxqnZwslVai2/v6HNZtgKYh5SwEU0VcKtgQyVAxAudRZlwFM0CPOuFOPN3bDsA3NLullsQ30u4h3K2KakFU3DnRJWgOS6DPV5KljNiUqGr3ApJX5QZf+DuazDKy+VxiEA/m9sELBCt9+5nmCZvd6IQRb7E1ANfES7zpyFLr95MTQQWvWLxgaSGCeWA0MRMAYx6x2mpCRjeETW+2g+TqWvDqzMSpBpXiHjSgo1Yt3yL4wROCiI03JE+Cpqhm+PBcoc/cUua7ERQE1Af9Nu99URWYZZb9v2IhYAbydVoNpVtds24RLz9l+oHbh3X00zBnW7Hz9Rh5M/bzjlu6zB542V79TjhCMIGaQ1GvKW66ngINvCWBFpCYMtZVY8uwgdMHAaQFuDFsHb/qy+vkQpWy8/TCYcYtPinn2eJWf2UFtakm/GxoUNgVyYhXL+eofRMrIqrV2fqT+QsYnNp7lkaE=
  - secure: mfog9OvSA/5V8ytAm6yOl6ZbD2WTEPkpZ5L0HWt9ubHiWm/4S3M1N0NH9HXo8pZOGayVKFm97KJS2G5JkMcOP3taFa5nVbKVU/Se8A0+W3zVzOcyulN3rO8z2LUVCUavXuY/5PqR0zovvSRV4l66BfaW+vC1MVcxEO8mpj/Toyc+BM5v+aVRN8lbR64MgoZ3T4UpNsL4KuQrFqUS0WMIGDYWcxtJuztWaDI6vAbkA7KdE93e2uz9nE1aNzGrolMj82rzOVm3D4H9QgogFiWHRpLYf4FrY7dov/7uz2z/fe9n3tJyRbEywIqRvnZG34CkvDnM0OrltLg/SM2GMx5yyxg1oxvIOxi1K3Jb6tWZdShg+cb9VuHyX+Kr5vlwv6jV4aWnc66tZg7mWpHtiZTMnNcng5pTrWJKWwZKaF+5E5NqShXteOX7SdBSPFzqq3BjHYG+UoA+JIfDK9ujKZ6NjmiJo1vVmgFsNrj1hlqpQG83v+hVXxOSBX5Kfp1qmjUxce9vRY44wjyS0+S2GTXV7o+7yE6+muXELCVsfatZ34XCp3RpnuP/cozpLPs1S40xo217iyMJ4UAwgLtrYAU1mhZNEZAm0XxE1eX2A/kpFbGAnkp7etAqhGMcY8GQBezpxiscAQGgqvPpN/VuRfItkOd90OInlkJN8BUdmLZNEpQ=
  - secure: QiAVJmBx1+toQYx4NDQloBMcNbPiF81c1xpD/C7ReJ0GTAWSdynioIv1nzw9mgu4wY493A/XyBRjFmsT/eNp1Fgw3xzTf9jamfgn8K6gESH6wUZjJzaRoNKy+gAmDePFkMOeFszWHmeEtHE8ViUGxjwI40TJBTnfUgoEFt3JitqHVyXgBJSDi6hzra9kTRRf7hhAWhIciRgPHntx4fIaHlybDGGwiK5IvFXBdLpGIA/H+XZg44PzVQ1y268dEsGINUMry4lFNLnSiLwhxD8UMO90oe1ZeAiHAlJMnLXjrldPG3rYDV3hQc49+iIApHz4IcBjl5Xp4/9nrhxAF37eby0QRxTtQZPrVks96fSMUpNOmZUtPDhfWZCqNcXgEtqwgxia2+GfIZAHtlMqCv2huL06HewMqoPMsDN22GmY33wR1RhJeZPoSVU0Mj5hljtemaimhtFBxmTc61HxWOpuAKtylKECvfuBEuXufK8rBEbqJsdNWgChWEopVDMtr6h7iW6iAcEbC8MjLWok1WauENDUIJkiC0OizGsp+zv7Oxsz4LOMI7v9KQYNm6LXqeDU+SDTb9sw3Fgl19sPDPY2M0o3qDu9T/Lqxe/E3M1t70xfa7XL2Hho6tF6xvj+XNdsihOdNnqy5kekeAVkOFs8f8DGGYmM2bZFZPeKotp6SFI=
  - COMMIT=${TRAVIS_COMMIT::8}

script:
  - docker login -u $DOCKER_USER -p $DOCKER_PASS
  - export REPO=karrlein/phpmetrics-server
  - export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH ; fi`
  - docker build -f Dockerfile -t $REPO:$COMMIT .
  - docker tag $REPO:$COMMIT $REPO:$TAG
  - docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
  - docker push $REPO

notifications:
    slack: karrlein:an1enYrAJKdow0DYS4sSvoGC
